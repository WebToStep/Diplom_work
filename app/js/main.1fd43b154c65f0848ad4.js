(()=>{"use strict";const e=e=>e.forEach((e=>{e.classList.add("show_block"),e.classList.remove("hidden_block")})),t=e=>{e[0].innerHTML="",e.forEach((e=>{e.classList.remove("show_block"),e.classList.add("hidden_block")}))},n=document.querySelector(".smooth-scroll"),o=e=>n.style.display=e,l=e=>{const t=document.querySelectorAll(".count_1"),n=document.querySelectorAll(".count_2"),o=document.querySelectorAll(".count_3"),l=document.querySelectorAll(".count_4"),c=()=>{const c=(new Date(e).getTime()-(new Date).getTime())/1e3,s=("0"+Math.floor(c%60)).slice(-2),r=("0"+Math.floor(c/60%60)).slice(-2),a=("0"+Math.floor(c/60/60%24)).slice(-2),i=("0"+Math.floor(c/60/60/24)).slice(-2);return t.forEach((e=>{e.lastChild.textContent=i})),n.forEach((e=>{e.lastChild.textContent=a})),o.forEach((e=>{e.lastChild.textContent=r})),l.forEach((e=>{e.lastChild.textContent=s})),c};(()=>{let e;c()>0?e=setInterval(c,1e3):(clearInterval(e),t.textContent="00",n.textContent="00",o.textContent="00",l.textContent="00")})()},c=document.getElementById("calc-type"),s=document.getElementById("calc-type-material"),r=document.getElementById("calc-input"),a=document.getElementById("calc-total");function i(e,t="+7 (___) ___-__-__"){const n=document.querySelectorAll(`input[name="${e}"]`);function o(e){const n=e.keyCode,o=t,l=o.replace(/\D/g,""),c=this.value.replace(/\D/g,"");let s=0,r=o.replace(/[_\d]/g,(e=>s<c.length?c.charAt(s++)||l.charAt(s):e));s=r.indexOf("_"),-1!=s&&(r=r.slice(0,s));let a=o.substr(0,this.value.length).replace(/_+/g,(e=>"\\d{1,"+e.length+"}")).replace(/[+()]/g,"\\$&");a=new RegExp("^"+a+"$"),(!a.test(this.value)||this.value.length<5||n>47&&n<58)&&(this.value=r),"blur"==e.type&&this.value.length<5&&(this.value="")}for(const e of n)e.addEventListener("input",o),e.addEventListener("focus",o),e.addEventListener("blur",o)}i("селектор элементов","маска, если маску не передать то будет работать стандартная +7 (___) ___-__-__");const d=document.querySelector(".overlay"),u=e=>{const t=e.parentNode.href;d.classList.add("show_block");const n=document.createElement("div"),o=document.createElement("div");n.className="sertificate-in-modal",n.innerHTML=`<img src="${t}" class="img-responsive" alt="">`,o.innerHTML='<span title="Close" class="sertificate-in-modal__close">X</span>',o.style.cssText="\n    position: absolute;\n    display: flex;\n    justify-content: center;\n    flex-direction: column;\n    right: 10px;\n    top: 10px;\n    width: 30px;\n    height: 30px;\n    background: #666;\n    border-radius: 50%;\n    color: #fff;\n    cursor: pointer;\n    font-weight: 600;\n    ",n.append(o),d.append(n)};document.addEventListener("DOMContentLoaded",(()=>{const n=document.getElementById("offer"),d=document.querySelector(".overlay"),m=document.querySelector(".header-modal"),v=document.querySelector(".services-modal");o("none"),document.querySelectorAll("form").forEach((e=>{e.addEventListener("submit",(t=>{t.preventDefault();const n=t.target.parentNode.querySelector(".help-block"),o=t.target.querySelector('input[name="fio"]'),l=t.target.querySelector('input[name="phone"]'),c=n.textContent;t.target.querySelectorAll("input").forEach((e=>e.addEventListener("focus",(e=>{e.target.style=""}))));const s=document.createElement("div");s.style.cssText="font-size: 1.5rem;\n                                          text-align: center;";const r=document.createElement("section");if(r.innerHTML="<div class='sk-circle-bounce'>\n                                       <div class='sk-child sk-circle-1'></div>\n                                       <div class='sk-child sk-circle-2'></div>\n                                       <div class='sk-child sk-circle-3'></div>\n                                       <div class='sk-child sk-circle-4'></div>\n                                       <div class='sk-child sk-circle-5'></div>\n                                       <div class='sk-child sk-circle-6'></div>\n                                       <div class='sk-child sk-circle-7'></div>\n                                       <div class='sk-child sk-circle-8'></div>\n                                       <div class='sk-child sk-circle-9'></div>\n                                       <div class='sk-child sk-circle-10'></div>\n                                       <div class='sk-child sk-circle-11'></div>\n                                       <div class='sk-child sk-circle-12'></div>\n                                   </div>",(()=>{let e;if(""===l.value&&""===o.value)l.style.border="1px solid red",o.style.border="1px solid red",n.textContent="",n.append(s),s.textContent="Заполните все поля!",s.style.cssText="\n                    font-size: 1.5rem;\n                    text-align: center;\n                    color: red",e=setTimeout((()=>{n.textContent=c,s.remove()}),5e3);else if(o.value.match(/[а-я a-z]{2,}/gi)){if(l.value.match(/[0-9()-]{9}/))return s.remove(),clearTimeout(e),s.style.cssText="\n                        font-size: 1.5rem;\n                        text-align: center;\n                        color: #666666",!0;l.style.border="1px solid red",n.textContent="",n.append(s),s.textContent="Ошибка в поле номер телефона!",s.style.cssText="\n                        font-size: 1.5rem;\n                        text-align: center;\n                        color: red",e=setTimeout((()=>{n.textContent=c,s.remove()}),5e3)}else o.style.border="1px solid red",n.textContent="",n.append(s),s.textContent="Ошибка в поле Ваше имя!",s.style.cssText="\n                       font-size: 1.5rem;\n                       text-align: center;\n                       color: red",e=setTimeout((()=>{n.textContent=c,s.remove()}),5e3);return!1})()){n.innerHTML="",n.append(s),s.append(r);const o=new FormData(e),l={};void 0!==localStorage.calc&&(l["calc-total"]=localStorage.calc),o.forEach(((e,t)=>l[t]=e)),console.log("body: ",l),(e=>fetch("./server.php",{method:"POST",headers:{"Content-Type":"aplication/json"},body:JSON.stringify(e)}))(l).then((e=>{if(200!==e.status)throw new Error(e.status);s.textContent="Спасибо! Мы скоро с вами свяжемся!"})).catch((e=>{s.textContent="Что то пошло не так...",console.error(e)})),t.target.querySelectorAll("input").forEach((e=>e.value="")),setTimeout((()=>{s.remove(),n.innerHTML="Мы гарантируем 100% конфиденциальность. Ваша информация не будет распространяться."}),5e3)}}))})),i("phone"),void 0===localStorage.startTimer?(localStorage.startTimer=((e,t)=>{const n=new Date(e);return n.setDate(n.getDate()+3),n})(new Date),l(localStorage.startTimer)):l(localStorage.startTimer),document.addEventListener("click",(n=>{const o=n.target,l=e=>e.trim().toLocaleLowerCase();o.classList.contains("fancyboxModal")&&(n.preventDefault(),l(o.innerText)===l("ЗАКАЗАТЬ ЗВОНОК!")||l(o.innerText)===l("УЗНАТЬ СВОЮ СКИДКУ")?e([d,m]):e([d,v])),o.parentNode.classList.contains("sertificate-document")&&(n.preventDefault(),u(o)),o.classList.contains("header-modal__close")?t([d,m]):o.classList.contains("services-modal__close")&&t([d,v]),o.classList.contains("overlay")&&(t([d,m]),t([d,v])),o.classList.contains("sertificate-in-modal__close")&&t([d]),o.classList.contains("smooth-scroll__img")&&window.scrollTo({top:0,behavior:"smooth"})})),document.addEventListener("input",(e=>{e.target.closest("#calc")&&(()=>{if(Number(c.value)&&Number(s.value)&&Number(r.value)){const e=Math.floor(c.value*s.value*r.value*1e3);a.value=e,localStorage.setItem("calc",e)}})()})),window.addEventListener("mouseover",(e=>{"html"!==e.target.localName&&e.target.parentNode.classList.contains("sertificate-document")&&(e.target.style.opacity=1)})),window.addEventListener("mouseout",(e=>{"html"!==e.target.localName&&e.target.parentNode.classList.contains("sertificate-document")&&(e.target.style="")})),window.addEventListener("scroll",(()=>{n.getBoundingClientRect().bottom<0?window.requestAnimationFrame((()=>{o("block")})):window.requestAnimationFrame((()=>{o("none")}))}))}))})();